(this["webpackJsonpproject-react"]=this["webpackJsonpproject-react"]||[]).push([[0],{14:function(e,t,n){e.exports={Login:"LoginRegister_Login__1Xgbk",register:"LoginRegister_register__SnuVs",error:"LoginRegister_error__3E2Hg"}},15:function(e,t,n){e.exports={Main:"Main_Main__TWBlU",header:"Main_header__2Qx-5",right:"Main_right__3c5VA",content:"Main_content__2Lmgh"}},2:function(e,t,n){e.exports={Home:"Home_Home__jw9yQ",container:"Home_container__1WTXh",poster:"Home_poster__2OxXc",info:"Home_info__4RHRY",title:"Home_title__xOUz-",plot:"Home_plot__YuxtV",movieInfo:"Home_movieInfo__1sDQl",guessInput:"Home_guessInput__uPI6V",submit:"Home_submit__2FMHO",guess:"Home_guess__1guw8",newMovie:"Home_newMovie__2WWbC",competition:"Home_competition__1Xphq",redButton:"Home_redButton__3Brsd",notFound:"Home_notFound__3-MlC",error:"Home_error__8SDTz"}},25:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var s=n(0),i=n(1),a=n(23),o=n.n(a),r=n(13),c=n(5),l=n(6),d=n(8),u=n(7),h=n(9),j=n(3),b=n(2),m=n.n(b),p={inputValue:"",movie:null,result:null},O=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).keypress=function(t){var n=t.keyCode||t.charCode||0;-1!==[13].indexOf(n)&&(e.state.result?e.loadRandomMovie():e.guessRating())},e.selectGenre=function(t){var n=t.target.value;e.genreList.includes(n)&&e.setState({selectedGenre:n},(function(){e.loadRandomMovie()}))},e.getGenres=function(){return Object(s.jsx)("select",{onChange:e.selectGenre,value:e.state.selectedGenre,children:e.genreList.map((function(e){return Object(s.jsx)("option",{value:e,children:e},e)}))})},e.getGuessIfGuessed=function(){var t=e.state.result;return t?Object(s.jsxs)("div",{className:m.a.guess,children:[Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{children:["Result: ",n.evaluateGuess(t)]}),Object(s.jsxs)("div",{children:["Your guess: ",t.ratingGuess,"/10"]}),Object(s.jsxs)("div",{children:["Rating: ",t.realRating.toFixed(1),"/10"]})]}),Object(s.jsx)("button",{className:m.a.newMovie,onClick:e.loadRandomMovie,children:"Try Other Movie"})]}):Object(s.jsxs)("div",{className:m.a.guessInput,children:[Object(s.jsx)("h4",{children:"Guess rating: "}),Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("input",{type:"number",id:"guess",step:"0.1",min:"0",max:"10",autoFocus:!0,value:e.state.inputValue,onChange:function(t){return e.updateInputValue(t)}}),Object(s.jsx)("span",{children:"/10"})]}),Object(s.jsx)("button",{className:m.a.submit,onClick:e.guessRating,children:"Submit"})]})]})},e.loadRandomMovie=function(){e.setState(p),fetch("http://localhost:3000/api/random-movie".concat("Any"!==e.state.selectedGenre&&e.genreList.includes(e.state.selectedGenre)?"?genre="+e.state.selectedGenre:"")).then((function(t){t.json().then((function(t){e.setState({movie:t})}))}))},e.guessRating=function(){var t=parseFloat(e.state.inputValue);t=t.toFixed(1),!isNaN(t)&&t<=10&&t>=0?(e.setState({Error:void 0}),fetch("http://localhost:3000/api/guess-rating",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({guess:t,imdbID:e.state.movie.imdbID})}).then((function(e){return e.json()})).then((function(t){e.setState({result:t})}))):e.setState({Error:"Guess must be between 0 and 10"})},e.genreList=["Any","Action","Adult","Adventure","Animation","Biography","Comedy","Crime","Documentary","Drama","Family","Film-Noir","Game-Show","History","Horror","Music","Musical","Mystery","News","Reality-TV","Romance","Sci-Fi","Short","Sport","Talk-Show","Thriller","War","Western"],e.state=p,document.body.addEventListener("keyup",e.keypress),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.loadRandomMovie()}},{key:"updateInputValue",value:function(e){this.setState({inputValue:e.target.value})}},{key:"render",value:function(){return this.state.movie?Object(s.jsxs)("div",{className:m.a.container,children:[Object(s.jsxs)("div",{className:m.a.Home,children:[Object(s.jsx)("object",{className:m.a.poster,data:"N/A"!==this.state.movie.Poster?this.state.movie.Poster:null,children:Object(s.jsx)("img",{src:"http://localhost:3000/no-poster.jpg",alt:"No poster"})}),Object(s.jsxs)("div",{className:m.a.info,children:[Object(s.jsxs)("div",{children:[Object(s.jsxs)("h2",{className:m.a.title,children:[this.state.movie.Title," (",this.state.movie.Year,")"]}),Object(s.jsxs)("div",{className:m.a.movieInfo,children:[Object(s.jsxs)("h4",{children:["Released: ","N/A"!==this.state.movie.Released?this.state.movie.Released:this.state.movie.Year]}),Object(s.jsxs)("h4",{children:["Genre: ",this.state.movie.Genre]}),Object(s.jsxs)("h4",{children:["Country: ",this.state.movie.Country]}),Object(s.jsxs)("h4",{children:["Runtime: ",this.state.movie.Runtime]}),Object(s.jsx)("h4",{children:"Summary:"})]}),Object(s.jsx)("p",{className:m.a.plot,children:this.state.movie.Plot})]}),this.getGuessIfGuessed()]})]}),this.state.Error?Object(s.jsx)("div",{className:m.a.error,children:this.state.Error}):null,Object(s.jsx)("div",{className:m.a.competition,children:Object(s.jsxs)("div",{children:[Object(s.jsx)("h4",{children:"Select genre"}),this.getGenres()]})})]}):Object(s.jsx)("div",{})}}],[{key:"evaluateGuess",value:function(e){var t=e.result;return 10===t?"Perfect":t>=9.7?"Close":t>=9?"Good":t>=8?"OK":t>=7?"Bad":"Really bad"}}]),n}(i.Component),g=n(26),v={inputValue:"",competition:null,movie:null,result:null},x={inputValue:"",movie:null,result:null},f=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).keypress=function(e){var t=e.keyCode||e.charCode||0;-1!==[13].indexOf(t)&&(i.state.result?i.loadNextMovie():i.guessRating())},i.checkLoginStatus=function(){return fetch("http://localhost:3000/auth/logged-in",{credentials:"include"}).then((function(e){i.setState({loggedIn:200===e.status})}))},i.getCompetition=function(){return fetch("http://localhost:3000/api/compete",{method:"POST",credentials:"include"}).then((function(e){return e.json()})).then((function(e){i.setState({competition:e})}))},i.getGuessIfGuessed=function(){var e=i.state.result;return e?Object(s.jsxs)("div",{className:m.a.guess,children:[Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{children:["Result: ",n.evaluateGuess(e)]}),Object(s.jsxs)("div",{children:["Your guess: ",e.ratingGuess,"/10"]}),Object(s.jsxs)("div",{children:["Rating: ",e.realRating.toFixed(1),"/10"]})]}),i.state.competition.finished?null:Object(s.jsx)("button",{className:m.a.newMovie,onClick:i.loadNextMovie,children:"Next movie"})]}):Object(s.jsxs)("div",{className:m.a.guessInput,children:[Object(s.jsx)("h4",{children:"Guess rating: "}),Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("input",{type:"number",id:"guess",step:"0.1",min:"0",max:"10",autoFocus:!0,value:i.state.inputValue,onChange:function(e){return i.updateInputValue(e)}}),Object(s.jsx)("span",{children:"/10"})]}),Object(s.jsx)("button",{className:m.a.submit,onClick:i.guessRating,children:"Submit"})]})]})},i.loadNextMovie=function(){i.setState(x);var e,t=i.state.competition,n=null,s=Object(g.a)(t.movies);try{for(s.s();!(e=s.n()).done;){var a=e.value;if(!a.guessed){n=a.imdbID;break}}}catch(o){s.e(o)}finally{s.f()}n?fetch("http://localhost:3000/api/movie?id=".concat(n),{credentials:"include"}).then((function(e){return e.json()})).then((function(e){i.setState({movie:e})})):(n=t.movies[9].imdbID,fetch("http://localhost:3000/api/movie?id=".concat(n),{credentials:"include"}).then((function(e){return e.json()})).then((function(e){i.setState({movie:e,result:t.movies[9].guess})})))},i.guessRating=function(){var e=parseFloat(i.state.inputValue);e=e.toFixed(1),!isNaN(e)&&e<=10&&e>=0?(i.setState({Error:void 0}),fetch("http://localhost:3000/api/compete-guess",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({guess:e,imdbID:i.state.movie.imdbID})}).then((function(e){return e.json()})).then((function(e){i.setState({result:e.ratedGuess,competition:e.competition})}))):i.setState({Error:"Guess must be between 0 and 10"})},i.newCompetition=function(){return i.setState({Error:void 0}),fetch("http://localhost:3000/api/compete",{method:"POST",credentials:"include",headers:{"Content-type":"application/json"},body:JSON.stringify({new:!0})}).then((function(e){return e.json()})).then((function(e){i.setState({competition:e}),i.loadNextMovie()}))},i.addToLeaderboard=function(){var e=i.state.competition;if(!i.state.competition.addedToLeaderboard)return fetch("http://localhost:3000/api/add-to-leaderboard",{method:"POST",credentials:"include"}).then((function(t){e.addedToLeaderboard=!0,i.setState(e),i.props.history.push("/leaderboard")}));i.setState({Error:"Already added to leaderboard"})},i.getAddToToLeaderboardButton=function(){if(i.state.competition.finished)return Object(s.jsx)("button",{className:m.a.redButton,onClick:i.addToLeaderboard,children:"Add to leaderboard"})},i.state=Object(r.a)(Object(r.a)({},v),{},{loggedIn:e.loginStatus}),document.body.addEventListener("keyup",i.keypress),i}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.state.loggedIn?this.getCompetition().then((function(){return e.loadNextMovie()})):this.checkLoginStatus().then((function(){e.state.loggedIn?e.getCompetition().then((function(){return e.loadNextMovie()})):e.props.history.push("/")}))}},{key:"updateInputValue",value:function(e){this.setState({inputValue:e.target.value})}},{key:"render",value:function(){return this.state.loggedIn?this.state.movie?Object(s.jsxs)("div",{className:m.a.container,children:[Object(s.jsxs)("div",{className:m.a.Home,children:[Object(s.jsx)("object",{className:m.a.poster,data:"N/A"!==this.state.movie.Poster?this.state.movie.Poster:null,children:Object(s.jsx)("img",{src:"http://localhost:3000/no-poster.jpg",alt:"No poster"})}),Object(s.jsxs)("div",{className:m.a.info,children:[Object(s.jsxs)("div",{children:[Object(s.jsxs)("h2",{className:m.a.title,children:[this.state.movie.Title," (",this.state.movie.Year,")"]}),Object(s.jsxs)("div",{className:m.a.movieInfo,children:[Object(s.jsxs)("h4",{children:["Released: ","N/A"!==this.state.movie.Released?this.state.movie.Released:this.state.movie.Year]}),Object(s.jsxs)("h4",{children:["Genre: ",this.state.movie.Genre]}),Object(s.jsxs)("h4",{children:["Country: ",this.state.movie.Country]}),Object(s.jsxs)("h4",{children:["Runtime: ",this.state.movie.Runtime]}),Object(s.jsx)("h4",{children:"Summary:"})]}),Object(s.jsx)("p",{className:m.a.plot,children:this.state.movie.Plot})]}),this.getGuessIfGuessed()]})]}),this.state.Error?Object(s.jsx)("div",{className:m.a.error,children:this.state.Error}):null,Object(s.jsx)("div",{className:m.a.competition,children:Object(s.jsxs)("div",{children:[Object(s.jsx)("h4",{children:"Competition stats"}),Object(s.jsxs)("div",{children:["Movies guessed: ",this.state.competition.guessedMovies,"/10"]}),Object(s.jsxs)("div",{children:["Current result: ",this.state.competition.currentResult,"/10"]}),Object(s.jsx)("button",{className:m.a.redButton,onClick:this.newCompetition,children:"New competition"}),this.getAddToToLeaderboardButton()]})})]}):Object(s.jsx)("div",{}):Object(s.jsx)("div",{children:"Make an account to compete"})}}],[{key:"evaluateGuess",value:function(e){var t=e.result;return 10===t?"Perfect":t>=9.7?"Close":t>=9?"Good":t>=8?"OK":t>=7?"Bad":"Really bad"}}]),n}(i.Component),y=n(14),S=n.n(y),N=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).attemptLogin=function(){s.state.loggedIn?s.setState({Error:"Already logged in"}):fetch("http://localhost:3000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s.state)}).then((function(e){if(200!==e.status)return e.json();s.props.checkLoginStatus(),s.props.history.push("/")})).then((function(e){e&&s.setState(e)}))},s.updateUsername=function(e){s.setState({username:e.target.value})},s.updatePassword=function(e){s.setState({password:e.target.value})},s.state={username:"",password:"",loggedIn:e.loginStatus},s}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return this.state.loggedIn&&this.props.history.push("/"),Object(s.jsx)("div",{className:S.a.Login,children:Object(s.jsxs)("form",{children:[Object(s.jsx)("h2",{children:"Login"}),Object(s.jsx)("label",{htmlFor:"username",children:"Username"}),Object(s.jsx)("input",{id:"username",type:"text",onChange:function(t){return e.updateUsername(t)}}),Object(s.jsx)("label",{htmlFor:"password",children:"Password"}),Object(s.jsx)("input",{id:"password",type:"password",onChange:function(t){return e.updatePassword(t)}}),this.state.Error?Object(s.jsx)("div",{className:S.a.error,children:this.state.Error}):null,Object(s.jsx)("button",{onClick:this.attemptLogin,children:"Sign in"}),Object(s.jsxs)("div",{id:S.a.register,children:["Not registered? ",Object(s.jsx)(h.b,{to:"register",children:"Create an account"})]})]})})}}]),n}(i.Component),_=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).attemptRegister=function(){fetch("http://localhost:3000/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s.state)}).then((function(e){if(200!==e.status)return e.json();s.props.history.push("/login")})).then((function(e){e&&s.setState(e)}))},s.updateUsername=function(e){s.setState({username:e.target.value})},s.updatePassword=function(e){s.setState({password:e.target.value})},s.updateConfirmPassword=function(e){s.setState({confirmPassword:e.target.value})},s.state={username:"",password:"",confirmPassword:"",loggedIn:s.props.loginStatus},s}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return this.state.loggedIn&&this.props.history.push("/"),Object(s.jsx)("div",{className:S.a.Login,children:Object(s.jsxs)("form",{children:[Object(s.jsx)("h2",{children:"Register"}),Object(s.jsx)("label",{htmlFor:"username",children:"Username"}),Object(s.jsx)("input",{id:"username",type:"text",onChange:function(t){return e.updateUsername(t)}}),Object(s.jsx)("label",{htmlFor:"password",children:"Password"}),Object(s.jsx)("input",{id:"password",type:"password",onChange:function(t){return e.updatePassword(t)}}),Object(s.jsx)("label",{htmlFor:"confirm_password",children:"Confirm Password"}),Object(s.jsx)("input",{id:"confirm_password",type:"password",onChange:function(t){return e.updateConfirmPassword(t)}}),this.state.Error?Object(s.jsx)("div",{className:S.a.error,children:this.state.Error}):null,Object(s.jsx)("button",{onClick:this.attemptRegister,children:"Sign up"}),Object(s.jsxs)("div",{id:S.a.register,children:["Already registered? ",Object(s.jsx)(h.b,{to:"login",children:"Sign in"})]})]})})}}]),n}(i.Component),C=n(15),k=n.n(C),w=n(25),R=n.n(w),I=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={leaderboard:[]},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch("http://localhost:3000/api/leaderboard").then((function(e){return e.json()})).then((function(t){e.setState({leaderboard:t})}))}},{key:"render",value:function(){var e=1;return this.state.leaderboard?Object(s.jsxs)("ol",{className:R.a.leaderboard,children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{children:"Position"}),Object(s.jsx)("div",{children:"Username"}),Object(s.jsx)("div",{children:"Result"})]},"header"),this.state.leaderboard.map((function(t){return Object(s.jsxs)("li",{children:[Object(s.jsx)("div",{children:e++}),Object(s.jsx)("div",{children:t.username}),Object(s.jsx)("div",{children:t.result})]},"pos"+e)}))]}):Object(s.jsx)("div",{})}}]),n}(i.Component),G=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(s.jsx)("div",{className:m.a.notFound,children:"404 Not Found"})}}]),n}(i.Component),M=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).logout=function(){return fetch("http://localhost:3000/auth/logout",{credentials:"include"}).then((function(e){window.location.reload()}))},e.checkLoginStatus=function(){return fetch("http://localhost:3000/auth/logged-in",{credentials:"include"}).then((function(t){e.setState({loggedIn:200===t.status})}))},e.renderOnLogin=function(){return e.state.loggedIn?Object(s.jsxs)("ul",{className:k.a.ul,children:[Object(s.jsx)("li",{children:Object(s.jsx)(h.c,{to:"/",children:"Home"})},"/"),Object(s.jsx)("li",{children:Object(s.jsx)(h.c,{to:"/compete",children:"Compete"})},"/compete"),Object(s.jsx)("li",{children:Object(s.jsx)(h.c,{to:"/leaderboard",children:"Leaderboard"})},"/leaderboard"),Object(s.jsx)("li",{className:k.a.right,children:Object(s.jsx)("button",{onClick:e.logout,children:"Sign out"})})]}):Object(s.jsxs)("ul",{className:k.a.ul,children:[Object(s.jsx)("li",{children:Object(s.jsx)(h.c,{to:"/",children:"Home"})},"/"),Object(s.jsx)("li",{children:Object(s.jsx)(h.c,{to:"/leaderboard",children:"Leaderboard"})},"/leaderboard"),Object(s.jsx)("li",{className:k.a.right,children:Object(s.jsx)(h.c,{to:"login",children:"Login"})},"/login"),Object(s.jsx)("li",{children:Object(s.jsx)(h.c,{to:"register",children:"Register"})},"/register")]})},e.state={},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.checkLoginStatus()}},{key:"render",value:function(){var e=this;return Object(s.jsx)(h.a,{children:Object(s.jsxs)("div",{className:k.a.Main,children:[Object(s.jsxs)("header",{className:k.a.header,children:[Object(s.jsx)("h1",{children:Object(s.jsx)(h.c,{to:"/",children:"Movie Rating Guessing Game"})}),this.renderOnLogin()]}),Object(s.jsx)("div",{className:k.a.content,children:Object(s.jsxs)(j.c,{children:[Object(s.jsx)(j.a,{exact:!0,path:"/",component:O}),Object(s.jsx)(j.a,{path:"/compete",render:function(t){return Object(s.jsx)(f,Object(r.a)(Object(r.a)({},t),{},{loginStatus:e.state.loggedIn}))}}),Object(s.jsx)(j.a,{path:"/login",render:function(t){return Object(s.jsx)(N,Object(r.a)(Object(r.a)({},t),{},{checkLoginStatus:e.checkLoginStatus,loginStatus:e.state.loggedIn}))}}),Object(s.jsx)(j.a,{path:"/register",render:function(t){return Object(s.jsx)(_,Object(r.a)(Object(r.a)({},t),{},{loginStatus:e.state.loggedIn}))}}),Object(s.jsx)(j.a,{path:"/leaderboard",component:I}),Object(s.jsx)(j.a,{path:"*",component:G})]})})]})})}}]),n}(i.Component);o.a.render(Object(s.jsx)(M,{}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.386e81a6.chunk.js.map